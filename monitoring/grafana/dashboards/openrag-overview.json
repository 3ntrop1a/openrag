{
  "__inputs": [],
  "__requires": [
    { "type": "grafana", "id": "grafana", "name": "Grafana", "version": "10.0.0" },
    { "type": "datasource", "id": "prometheus", "name": "Prometheus", "version": "1.0.0" }
  ],
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 100,
      "title": "API Gateway",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 1 },
      "id": 1,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "orientation": "auto", "text": {}, "textMode": "auto", "colorMode": "background" },
      "pluginVersion": "10.0.0",
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"openrag-api\"}", "instant": true, "refId": "A" }],
      "title": "API Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "reqps" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 1 },
      "id": 2,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(http_requests_total{job=\"openrag-api\"}[5m])", "legendFormat": "{{method}} {{route}} {{status_code}}", "refId": "A" }
      ],
      "title": "API Request Rate",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "s" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 1 },
      "id": 3,
      "options": { "legend": { "calcs": ["mean", "p95"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket{job=\"openrag-api\"}[5m]))", "legendFormat": "p95 {{route}}", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.50, rate(http_request_duration_seconds_bucket{job=\"openrag-api\"}[5m]))", "legendFormat": "p50 {{route}}", "refId": "B" }
      ],
      "title": "API Response Latency",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 9 },
      "id": 101,
      "title": "Orchestrator",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 10 },
      "id": 10,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"openrag-orchestrator\"}", "instant": true, "refId": "A" }],
      "title": "Orchestrator Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "short" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 10 },
      "id": 11,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(documents_processed_total{job=\"openrag-orchestrator\"}[5m])", "legendFormat": "Documents processed/s", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(documents_failed_total{job=\"openrag-orchestrator\"}[5m])", "legendFormat": "Documents failed/s", "refId": "B" }
      ],
      "title": "Document Processing Rate",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "s" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 10 },
      "id": 12,
      "options": { "legend": { "calcs": ["mean"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.95, rate(query_processing_duration_seconds_bucket{job=\"openrag-orchestrator\"}[5m]))", "legendFormat": "p95 query latency", "refId": "A" }
      ],
      "title": "Query Processing Latency",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 18 },
      "id": 102,
      "title": "Embedding Service",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 19 },
      "id": 20,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"openrag-embedding\"}", "instant": true, "refId": "A" }],
      "title": "Embedding Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "short" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 19 },
      "id": 21,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(embeddings_generated_total{job=\"openrag-embedding\"}[5m])", "legendFormat": "Embeddings/s", "refId": "A" }
      ],
      "title": "Embedding Throughput",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "s" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 19 },
      "id": 22,
      "options": { "legend": { "calcs": ["mean", "p95"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.95, rate(embedding_duration_seconds_bucket{job=\"openrag-embedding\"}[5m]))", "legendFormat": "p95 embedding time", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.50, rate(embedding_duration_seconds_bucket{job=\"openrag-embedding\"}[5m]))", "legendFormat": "p50 embedding time", "refId": "B" }
      ],
      "title": "Embedding Latency",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 27 },
      "id": 103,
      "title": "Qdrant (Vector Store)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 28 },
      "id": 30,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"qdrant\"}", "instant": true, "refId": "A" }],
      "title": "Qdrant Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "short" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 28 },
      "id": 31,
      "options": { "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "app_collections_total{job=\"qdrant\"}", "legendFormat": "Collections", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "sum(app_vectors_total{job=\"qdrant\"})", "legendFormat": "Total Vectors", "refId": "B" }
      ],
      "title": "Qdrant Collections & Vectors",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "reqps" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 28 },
      "id": 32,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(rest_responses_total{job=\"qdrant\"}[5m])", "legendFormat": "{{method}} {{status}}", "refId": "A" }
      ],
      "title": "Qdrant Request Rate",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 36 },
      "id": 104,
      "title": "PostgreSQL",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 37 },
      "id": 40,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"postgres-exporter\"}", "instant": true, "refId": "A" }],
      "title": "PostgreSQL Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "short" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 37 },
      "id": 41,
      "options": { "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "pg_stat_activity_count{job=\"postgres-exporter\"}", "legendFormat": "Active connections ({{state}})", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "pg_settings_max_connections{job=\"postgres-exporter\"}", "legendFormat": "Max connections", "refId": "B" }
      ],
      "title": "PostgreSQL Connections",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "ops" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 37 },
      "id": 42,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(pg_stat_database_xact_commit_total{job=\"postgres-exporter\",datname=\"openrag_db\"}[5m])", "legendFormat": "Commits/s", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(pg_stat_database_xact_rollback_total{job=\"postgres-exporter\",datname=\"openrag_db\"}[5m])", "legendFormat": "Rollbacks/s", "refId": "B" }
      ],
      "title": "PostgreSQL Transactions",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 45 },
      "id": 105,
      "title": "Redis",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 46 },
      "id": 50,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"redis-exporter\"}", "instant": true, "refId": "A" }],
      "title": "Redis Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "short" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 46 },
      "id": 51,
      "options": { "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "redis_connected_clients{job=\"redis-exporter\"}", "legendFormat": "Connected clients", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "redis_blocked_clients{job=\"redis-exporter\"}", "legendFormat": "Blocked clients", "refId": "B" }
      ],
      "title": "Redis Clients",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "ops" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 46 },
      "id": 52,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(redis_commands_processed_total{job=\"redis-exporter\"}[5m])", "legendFormat": "Commands/s", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(redis_keyspace_hits_total{job=\"redis-exporter\"}[5m])", "legendFormat": "Cache hits/s", "refId": "B" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(redis_keyspace_misses_total{job=\"redis-exporter\"}[5m])", "legendFormat": "Cache misses/s", "refId": "C" }
      ],
      "title": "Redis Ops & Cache",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 54 },
      "id": 106,
      "title": "MinIO (Object Storage)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 55 },
      "id": 60,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"minio\"}", "instant": true, "refId": "A" }],
      "title": "MinIO Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "bytes" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 55 },
      "id": 61,
      "options": { "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "minio_cluster_usage_total_bytes{job=\"minio\"}", "legendFormat": "Total usage", "refId": "A" }
      ],
      "title": "MinIO Storage Usage",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "Bps" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 55 },
      "id": 62,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(minio_s3_traffic_received_bytes{job=\"minio\"}[5m])", "legendFormat": "Received", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(minio_s3_traffic_sent_bytes{job=\"minio\"}[5m])", "legendFormat": "Sent", "refId": "B" }
      ],
      "title": "MinIO S3 Traffic",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 63 },
      "id": 107,
      "title": "Ollama (LLM)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "options": { "0": { "text": "DOWN" }, "1": { "text": "UP" } }, "type": "value" }] },
        "overrides": []
      },
      "gridPos": { "h": 3, "w": 4, "x": 0, "y": 64 },
      "id": 70,
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "up{job=\"ollama\"}", "instant": true, "refId": "A" }],
      "title": "Ollama Status",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "reqps" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 4, "y": 64 },
      "id": 71,
      "options": { "legend": { "calcs": ["mean", "max"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "rate(ollama_request_duration_seconds_count{job=\"ollama\"}[5m])", "legendFormat": "{{model}} {{code}}", "refId": "A" }
      ],
      "title": "Ollama Request Rate",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "s" }, "overrides": [] },
      "gridPos": { "h": 8, "w": 10, "x": 14, "y": 64 },
      "id": 72,
      "options": { "legend": { "calcs": ["mean", "p95"], "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.95, rate(ollama_request_duration_seconds_bucket{job=\"ollama\"}[5m]))", "legendFormat": "p95 {{model}}", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "${datasource}" }, "expr": "histogram_quantile(0.50, rate(ollama_request_duration_seconds_bucket{job=\"ollama\"}[5m]))", "legendFormat": "p50 {{model}}", "refId": "B" }
      ],
      "title": "Ollama Generation Latency",
      "type": "timeseries"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "tags": ["openrag"],
  "templating": {
    "list": [
      {
        "current": {},
        "hide": 0,
        "includeAll": false,
        "name": "datasource",
        "options": [],
        "query": "prometheus",
        "refresh": 1,
        "type": "datasource",
        "label": "Datasource"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "OpenRAG Overview",
  "uid": "openrag-overview",
  "version": 1
}
